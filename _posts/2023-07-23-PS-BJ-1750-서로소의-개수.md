---
title: "ë°±ì¤€ 1750ë²ˆ: ì„œë¡œì†Œì˜ ê°œìˆ˜"
date: 2023-07-24 02:41:24 +0900 
categories: [problem_solving]
tags: [problem_solving, dynamic_programming]
math: true
---

# [ë°±ì¤€ 1750ë²ˆ: ì„œë¡œì†Œì˜ ê°œìˆ˜](https://www.acmicpc.net/problem/1750)  

[ë¬¸ì œ ì›ë¬¸](https://www.acmicpc.net/problem/1750)  

## í’€ì´  

$dp_{n}$ì„ í˜„ìž¬ê¹Œì§€ ì„ íƒí•œ ìŒë“¤ ì¤‘ì—ì„œ ìµœëŒ€ ê³µì•½ìˆ˜ê°€ $n$ì¸ ìŒì˜ ê°œìˆ˜ë¼ê³  í•˜ìž. ê·¸ë ‡ë‹¤ë©´ ì „ì²´ ìˆ˜ì—´ $S$ì— ëŒ€í•œ $dp$ëŠ” ì•„ëž˜ì™€ ê°™ì€ ê³¼ì •ì„ ê±°ì³ êµ¬í•  ìˆ˜ ìžˆë‹¤. ê¸€ë¡œ í’€ì–´ì„œ ì„¤ëª…í•˜ê³  ì‹¶ì—ˆìœ¼ë‚˜, ì–´ë–»ê²Œ í’€ì–´ì„œ ì„¤ëª…í• ì§€ ê°ì´ ì•ˆ ì™€ì„œ ìš°ì„  ì˜ì‚¬ì½”ë“œë¡œ ì˜®ê²¨ë´¤ë‹¤. ðŸ™„  

$\textbf{for}\ i \leftarrow 1\ \textbf{to}\ 100,000\ \textbf{do}$  
$\quad dp_i \leftarrow 0$  
$\textbf{end for}$  

$\textbf{for} \ i \leftarrow 1\ \textbf{to}\ N\ \textbf{do}$  
$\quad \textbf{for}\ n \leftarrow 1\ \textbf{to}\ 100,000\ \textbf{do}$  
$\quad\quad x \leftarrow gcd(n, s_i)$  
$\quad\quad dp_x \leftarrow dp_x + dp_n$  
$\quad \textbf{end for}$  
$\quad dp_{s_i} \leftarrow dp_{s_i}+1$  
$\textbf{end for}$  

$s_i$ëŠ” ìˆ˜ì—´ $S$ì˜ $i$ë²ˆì§¸ ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. ë§Œì•½ ì–´ë– í•œ ìµœì í™”ë„ í•˜ì§€ ì•Šê³  $naive$í•˜ê²Œ ì ‘ê·¼í•œë‹¤ë©´, $O(2^N)$ì˜ ì‹œê°„ ë³µìž¡ë„ë¡œ í’€ì´í•  ìˆ˜ ìžˆì„ ê²ƒì´ë‹¤. ì´ ë°©ë²•ì€ $N$ì´ ì–´ëŠ ì •ë„ ì»¤ì§€ê²Œ ë˜ë©´ ë„ˆë¬´ ë§Žì€ ì‹œê°„ì´ ì†Œëª¨ë˜ë¯€ë¡œ, ì ë‹¹í•œ ì‹œê°„ì„ ì†Œëª¨í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ì„ ë– ì˜¬ë¦´ í•„ìš”ê°€ ìžˆë‹¤.  

ì´ì œ ë°°ë‚­ ë¬¸ì œì—ì„œì˜ ì•„ì´ë””ì–´ë¥¼ ì‘ìš©í•´ë³´ìž. $S$ì˜ $i$ë²ˆì§¸ ìˆ˜ëŠ” í¬í•¨ë˜ê±°ë‚˜, í¬í•¨ë˜ì§€ ì•ŠëŠ” ë‘ ê°€ì§€ ê²½ìš°ê°€ ì¡´ìž¬í•œë‹¤. $i$ë²ˆì§¸ ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ê²½ìš°ëŠ” $(1)$ê³¼ ê°™ì„ ê²ƒì´ê³ , í¬í•¨í•˜ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” $(2)$ì™€ ê°™ì„ ê²ƒì´ë‹¤.  

$(1)\quad dp_{gcd(n, s_i)} \leftarrow dp_{gcd(n, s_i)}+dp_n$  
$(2)\quad dp_n \leftarrow dp_n$  

$(1)$ê³¼ ê°™ì€ í˜•íƒœê°€ ë˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ê¸°ì¡´ì— ìµœëŒ€ ê³µì•½ìˆ˜ê°€ $n$ì¸ ìŒì— $s_i$ë¥¼ í¬í•¨í•˜ëŠ” ìƒˆë¡œìš´ ìŒì„ ë§Œë“¤ë©´ í•´ë‹¹ ìŒì˜ ìµœëŒ€ ê³µì•½ìˆ˜ëŠ” $gcd(n, s_i)$ê°€ ëœë‹¤. ì´ëŠ” ìµœëŒ€ ê³µì•½ìˆ˜ê°€ $gcd(n, s_i)$ì¸ ìƒˆë¡œìš´ ìŒì„ ë§Œë“  ê²ƒì´ê³ , ìƒˆë¡œìš´ ìŒì˜ ê°œìˆ˜ëŠ” $dp_n$ê°€ ê°™ìœ¼ë¯€ë¡œ $dp_{gcd(n, s_i)}$ì˜ ê°’ì„ $dp_n$ ë§Œí¼ ì¦ê°€ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.  

ë”°ë¼ì„œ ìˆ˜ì—´ $S$ì˜ ëª¨ë“  ì›ì†Œì— ëŒ€í•˜ì—¬ ì°¨ë¡€ ì°¨ë¡€ ìœ„ì˜ ê³¼ì •ì„ ë°˜ë³µí•˜ë©´ ì „ì²´ ìˆ˜ì—´ $S$ì— ëŒ€í•œ $dp$ë¥¼ êµ¬í•  ìˆ˜ ìžˆë‹¤.  

## ì†ŒìŠ¤ ì½”ë“œ  

``` kotlin
// https://www.acmicpc.net/problem/1750

package BJ_1750_ì„œë¡œì†Œì˜_ê°œìˆ˜

import kotlin.math.*

const val S = 100_000
const val M = 10_000_003

@Suppress("NAME_SHADOWING")
fun gcd(a: Int, b: Int): Int {
    var (a, b) = Pair(max(a, b), min(a, b))
    while (a % b != 0) {
        val r = a % b
        a = b
        b = r
    }
    return b
}

fun main() = System.`in`.bufferedReader().use { stdin ->
    val dp = IntArray(S + 1) { 0 }

    repeat(stdin.readLine().toInt()) {
        val n = stdin.readLine().toInt()
        for (i in 1..S) {
            if (0 < dp[i]) {
                val gcd = gcd(i, n)
                dp[gcd] = (dp[gcd] + dp[i]) % M
            }
        }

        dp[n] = (dp[n] + 1) % M
    }

    println(dp[1])
}
```
